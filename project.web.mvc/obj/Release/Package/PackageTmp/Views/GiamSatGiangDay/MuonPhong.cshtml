@{
    ViewBag.Title = "Mượn phòng";
    Layout = "~/Views/Shared/_LayoutAngular.cshtml";
}

<div id="page-heading">
    <ol class="breadcrumb">
        <li>
            <a href="@Url.Action("Index", "Home")">
                <i class="fa fa-lg fa-home text-warning text-size-20">
                </i> Trang chủ
            </a>
        </li>
        <li class="active">
            Mượn phòng
        </li>
    </ol>
</div>
<div class="container" ng-controller="MuonPhongCtrl">
    <div ng-show="ThongTinPhieuView.length == 0">
        <div class="col-sm-12 form-group">
            <b>Tìm giảng viên:</b>
            <br />
            <input type="text" id="hidden_giangvienguid" ng-model="NhanVienGuid" style="display:none;" />
            <input type="text" class="col-sm-3" id="text_GiangVienID" placeholder="Tìm và chọn giảng viên cần báo nghỉ" />
        </div>
        <hr />

        <div class="col-sm-12 form-group">
            <div ng-show="NhanVienGuid.length > 0">
                <b>Giảng viên</b>:
                <span id="lblName"></span>
            </div>
            <div id="lblName" ng-show="NhanVienGuid.length == 0">
                Xin vui lòng nhập Họ tên Giảng viên
            </div>
        </div>

        <div class="col-sm-12 form-group">
            <b>Lý do</b>:
        </div>
        <div class="col-sm-12 form-group">
            <textarea ng-model="LyDo" style="width:100%;" rows="2"></textarea>
        </div>
    </div>
    <div ng-show="idParameter != ''">
        <div class="col-sm-12 form-group">
            <b>Giảng viên</b>: {{ThongTinPhieuView.HoTen}} - {{ThongTinPhieuView.NhanVienID}} - {{ThongTinPhieuView.DonViName}}
        </div>
        <div class="col-sm-12 form-group">
            <b>Lý do</b>: {{ThongTinPhieuView.NoiDung}}
        </div>
    </div>
    <div class="col-sm-12 form-group">
        <div class="col-sm-6 nopadding"><b>Danh sách các ngày mượn</b></div>
    </div>
    <div class="col-sm-12" ng-show="ThongTinPhieuView.TrangThai != 1">
        <div class="col-sm-3">
            <md-datepicker name="NgayMuonPhong" ng-model="NgayMuonPhong" md-min-date="minDate" md-placeholder="Chọn ngày" required></md-datepicker>
            <i class="fa fa-exclamation-triangle text-danger" ng-show="NgayMuonPhong.$invalid && !NgayMuonPhong.$pristine">
                Không được để trống
            </i>
        </div>
        <div class="col-sm-2">
            <select class="form-control"
                    ng-model="TietBatDau"
                    ng-options="itemValue.value as itemValue.name for itemValue in listTietBatDau">
                <option value="Tiết">Tiết bắt đầu</option>
            </select>
        </div>
        <div class="col-sm-2">
            <select class="form-control"
                    ng-model="TietKetThuc"
                    ng-options="itemValue.value as itemValue.name for itemValue in listTietKetThuc"
                    @*ng-init="TietBatDau=checkChonTietKetThuc(item.TietKetThuc)"
                                    ng-change="chonTietKetThuc(TietKetThuc)"*@>
                <option value="Tiết">Tiết kết thúc</option>
            </select>
        </div>
        <div class="col-sm-2">
            <button id="btnLuu"
                    type="button"
                    title="Lưu"
                    class="btn btn-primary"
                    ng-click="addChiTiet()"
                    ng-show="TrangThai == 0"
                    ng-disabled="NhanVienGuid.length == 0">
                Thêm buổi
            </button>
        </div>
    </div>
    <div ng-show="listAdd.length > 0">
        <div class="col-sm-12 form-group">
            <table cellpadding="0" cellspacing="0" border="0" class="table table-bordered datatables">
                <thead>
                    <tr>
                        <th class="w-30">STT</th>
                        <th>Ngày mượn</th>
                        <th class="w-100">Tiết bắt đầu</th>
                        <th class="w-100">Tiết kết thúc</th>
                        <th class="w-100">Phòng</th>
                        <th class="w-30" ng-show="ThongTinPhieuView.TrangThai != 1">#</th>
                    </tr>
                </thead>

                <tbody ng-repeat="item in listAdd">
                    <tr>
                        <td>{{$index + 1}}</td>
                        <td>{{formatShow(item.NgayMuonPhong)}}</td>
                        <td>{{item.TietBatDau}}</td>
                        <td>{{item.TietKetThuc}}</td>
                        <td>{{item.PhongID}}</td>
                        <td  ng-show="ThongTinPhieuView.TrangThai != 1">
                            <a ng-click="fnDeleteNgay($index)"><i class="fa fa-lg fa-trash-o text-danger"></i></a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="col-sm-12 " ng-show="listAdd.length == 0">
        <div class="alert alert-dismissable alert-info">
            <strong>Chưa thêm dữ liệu mượn phòng!</strong>
        </div>
    </div>
    <div class="col-sm-12 text-center">

        <button id="btnLuuPhieu"
                type="button"
                title="Lưu thông tin mượn phòng"
                class="btn btn-success"
                ng-click="savePhieu()"
                data-otf-id="@ViewBag.UserGuid"
                ng-show="listAdd.length > 0 && TrangThai == 0">
            Gửi yêu cầu mượn phòng
        </button>
        <button id="btnXoaPhieu"
                type="button"
                title="Xóa phiếu"
                class="btn btn-danger"
                ng-click="deletePhieu(ThongTinPhieuView.PhieuMuonPhongGuid)"
                ng-show="ThongTinPhieuView.TrangThai != 1 && idParameter != ''"
                confirm-click="Bạn có chắc chắn xóa phiếu này?">
            Xóa phiếu
        </button>
        &nbsp;
        <button id="btnQuayLai"
                type="button"
                title="Quay lại"
                class="btn btn-default"
                ng-click="BackPage()">
            Quay lại
        </button>
    </div>


</div>

@section Styles {
    <link href="~/Content/plugins/EasyAutocomplete/easy-autocomplete.css" rel="stylesheet" />
}


@section Scripts {
    <script src="~/Content/plugins/EasyAutocomplete/jquery.easy-autocomplete.js"></script>
    <script src="~/angularApp/app/GiamSatHoatDongGiangDay/MuonPhong/MuonPhongCtrl.js"></script>
    <script type="text/javascript">
        function openNav() {
            document.getElementById("mySidenav").style.width = "40%";
            document.getElementById("mySidenav").style.border = "1px solid #ccc";
            document.getElementById("mySidenav").style.paddingLeft = "2%";
            document.getElementById("mySidenav").style.paddingRight = "2%";
        }

        function closeNav() {
            document.getElementById("mySidenav").style.width = "0";
            document.getElementById("mySidenav").style.border = "0px";
            document.getElementById("mySidenav").style.paddingLeft = "0";
            document.getElementById("mySidenav").style.paddingRight = "0";
        }
    </script>>
}